<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
</head>

<body>
    <h1 class="text-center my-5">Employee Managment System</h1>

    <form action="">
        <div class="container">
            <div class="row">
                <div class="col-6">
                    <div class="mb-3">
                        <label for="name" class="form-label">Name :</label>
                        <input type="text" class="form-control" id="name">
                    </div>
                </div>
                <div class="col-6">
                    <div class="mb-3">
                        <label for="mail" class="form-label">Email :</label>
                        <input type="email" class="form-control" id="mail">
                    </div>
                </div>
                <div class="col-6">
                    <div class="mb-3">
                        <label for="salary" class="form-label">Salary :</label>
                        <input type="number" class="form-control" id="salary">
                    </div>
                </div>
                <div class="col-6">
                    <div class="mb-3">
                        <label for="dept" class="form-label">Department :</label>
                        <select name="dept" id="dept" class="form-select">
                            <option value="">Select Department</option>
                            <option value="1">Finance</option>
                            <option value="2">IT</option>
                            <option value="3">Computer</option>
                            <option value="4">Civil</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="text-center my-4">
                <button class="btn btn-primary" id="subbtn">Add Employee</button>
                <a class="btn btn-success" href="./employee.html">View Employee</a>
            </div>
        </div>
    </form>

    <script>
        let employees = JSON.parse(localStorage.getItem("emplpoyees")) == null ? [] : JSON.parse(localStorage.getItem("emplpoyees"));
        // let employees = JSON.parse(localStorage.getItem("emplpoyees")) || [];

        let editIdx = null;
        let editEmp;

        const btn = document.getElementById("subbtn");

        btn.addEventListener("click", function (e) {
            e.preventDefault();

            let name = document.getElementById("name").value;
            let mail = document.getElementById("mail").value;
            let salary = document.getElementById("salary").value;
            let dept = document.getElementById("dept").value;

            if (editIdx) {
                employees[editIdx].name = name;
                employees[editIdx].mail = mail;
                employees[editIdx].salary = salary;
                employees[editIdx].dept = dept;

                localStorage.setItem("emplpoyees", JSON.stringify(employees));
                window.location.pathname = "./employee.html";
            } else {
                let emp = {
                    id: Date.now(),
                    name, mail, salary, dept
                }

                employees.push(emp);
                localStorage.setItem("emplpoyees", JSON.stringify(employees));
                window.location.pathname = "./employee.html";
            }
        })

        document.addEventListener("DOMContentLoaded", function () {
            editIdx = JSON.parse(localStorage.getItem("editIdx"));
            editEmp = employees[editIdx];

            if (editIdx !== null && editIdx !== undefined) {
                btn.innerHTML = "Update Employee";

                document.getElementById("name").value = editEmp.name;
                document.getElementById("mail").value = editEmp.mail;
                document.getElementById("salary").value = editEmp.salary;
                document.getElementById("dept").value = editEmp.dept;
            }
        })

    </script>
</body>

</html>